Сделаем бинпоиск по ответу. Для фиксированного числа удалений, получим строку `t`. Далее проверим двумя указателями что из текущей строки можно получить `p`. 

Асимптотика $O(n \log n)$.

<!-- AC like https://codeforces.com/contest/779/submission/56385229 -->